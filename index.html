<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Progressive Clock with Random Mode</title>

</head>
<body>
    <h1>Flash</h1>
    <div id="clock">--:--:--</div>
    <div id="admin-section" class="hidden">
        <div id="chart"></div>
        <div id="controls">
            <button onclick="togglePause()">Pause/Resume</button>
            <button onclick="toggleMode()">Switch Mode (Linear/Exponential)</button>
            <button onclick="enableRandomMode()">Random Mode</button>
        </div>
    </div>
    
    <button id="admin-btn">Admin</button>

    <script>

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./service-worker.js').then(() => {
                console.log('Service Worker Registered');
            });
        }

        // Configuration
        const START_TIME = 9; // 9:00 AM
        const PEAK_TIME = 16; // 4:00 PM
        const END_TIME = 18.5; // 6:30 PM
        const TICK_INTERVAL = 1000; // 1 second in real time
        const MAX_SPEED = 5; // Maximum speed multiplier at peak
        const RANDOM_MIN_INTERVAL = 5000; // Min 5 seconds for random switch
        const RANDOM_MAX_INTERVAL = 15000; // Max 15 seconds for random switch

        // State variables
        let currentTime = new Date(); // Start with the current real-world time
        let paused = false;
        let linearMode = true; // Linear progression initially
        let randomModeActive = false;
        let chartData = [];
        let interval;
        let randomInterval;

        // Utility Functions
        function calculateSpeedMultiplier(hour) {
            if (hour < START_TIME || hour > END_TIME) return 1; // Real-world speed
            const normalizedTime = (hour - START_TIME) / (END_TIME - START_TIME);
            if (hour <= PEAK_TIME) {
                return linearMode
                    ? 1 + normalizedTime * (MAX_SPEED - 1) // Linear speed-up
                    : 1 + (Math.exp(normalizedTime) - 1) * (MAX_SPEED - 1); // Exponential speed-up
            } else {
                const reverseTime = (END_TIME - hour) / (END_TIME - PEAK_TIME);
                return linearMode
                    ? 1 + reverseTime * (MAX_SPEED - 1) // Linear slow-down
                    : 1 + (Math.exp(reverseTime) - 1) * (MAX_SPEED - 1); // Exponential slow-down
            }
        }

        function updateClock() {
            if (paused) {
                renderClock(new Date()); // Show real-world time when paused
                return;
            }

            const currentHour = currentTime.getHours() + currentTime.getMinutes() / 60;
            const speedMultiplier = currentHour >= START_TIME && currentHour <= END_TIME
                ? calculateSpeedMultiplier(currentHour) // Progressive speed
                : 1; // Real-world speed

            chartData.push(speedMultiplier);
            renderChart();

            currentTime = new Date(currentTime.getTime() + TICK_INTERVAL * speedMultiplier);
            renderClock(currentTime);
        }

        function renderClock(time) {
            let hours = time.getHours();
            const minutes = time.getMinutes().toString().padStart(2, '0');
            const seconds = time.getSeconds().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12 || 12; // Convert to 12-hour format
            document.getElementById('clock').textContent = `${hours}:${minutes}:${seconds} ${ampm}`;
        }

        function renderChart() {
            const chart = document.getElementById('chart');
            chart.innerHTML = ''; // Clear previous lines
            const maxWidth = chart.offsetWidth;
            const maxHeight = chart.offsetHeight;
            const maxSpeed = Math.max(...chartData, MAX_SPEED);
            chartData.forEach((speed, index) => {
                const line = document.createElement('div');
                line.className = 'line';
                line.style.width = `${maxWidth / chartData.length}px`;
                line.style.left = `${(index / chartData.length) * maxWidth}px`;
                line.style.height = `${(speed / maxSpeed) * maxHeight}px`;
                chart.appendChild(line);
            });
        }

        function togglePause() {
            paused = !paused;
            if (paused) {
                alert('Paused: Showing real-world time.');
            } else {
                alert('Resumed: Returning to accelerated/progressive time.');
                currentTime = new Date(); // Sync with real-world time
            }
        }

        function toggleMode() {
            linearMode = !linearMode;
            alert(`Switched to ${linearMode ? 'Linear' : 'Exponential'} mode.`);
        }

        function enableRandomMode() {
            if (randomModeActive) {
                clearInterval(randomInterval);
                randomModeActive = false;
                alert('Random mode disabled.');
            } else {
                randomModeActive = true;
                alert('Random mode enabled.');
                scheduleRandomSwitch();
            }
        }

        function scheduleRandomSwitch() {
            if (!randomModeActive) return;

            const randomTime = Math.random() * (RANDOM_MAX_INTERVAL - RANDOM_MIN_INTERVAL) + RANDOM_MIN_INTERVAL;
            randomInterval = setTimeout(() => {
                linearMode = !linearMode;
                alert(`Random mode switched to ${linearMode ? 'Linear' : 'Exponential'} mode.`);
                scheduleRandomSwitch();
            }, randomTime);
        }

        // Initialization: Determine mode based on real-world time
        const currentHour = currentTime.getHours() + currentTime.getMinutes() / 60;
        if (currentHour < START_TIME || currentHour > END_TIME) {
            // Outside working hours: Use real-world time
            currentTime = new Date();
        }

        // Start the clock
        renderClock(currentTime);
        interval = setInterval(updateClock, TICK_INTERVAL);

        const adminBtn = document.getElementById("admin-btn");
        const adminSection = document.getElementById("admin-section");

        adminBtn.addEventListener("click", () => {
        const password = prompt("Enter Admin Password:");
        if (password === "intribe") {
           
            adminSection.classList.remove("hidden");
            adminBtn.classList.add("hidden");
        } else {
            alert("Incorrect Password");
        }
        });
    </script>
</body>
</html>
